# Key table copied from memory
key = [0xDE, 0xD9, 0xA1, 0xF9, 0xED, 0xC0, 0xA8, 0xFF,
       0xE1, 0xD6, 0xAC, 0x91, 0xA0, 0xC6, 0xE7, 0xF2, 0xBC,
       0xA6, 0xE6, 0xF9, 0xB2, 0xAB, 0xAF, 0xAB, 0xBD, 0xEE,
       0xBC, 0xF7, 0xB1, 0xFC, 0xBB, 0xAE, 0xDD, 0x9A, 0xCB,
       0x80, 0xC8, 0xD8, 0x96, 0xD4, 0xBC]

flag = bytearray(open("flag.enc", "rb").read())

# FUN_0010250 decoded:
rand = key[(83 ^ 0xA5) % 0x29] ^ 83 ^ flag[83]

for i in range(len(flag) - 1):
    flag[i] ^= i ^ (key[(i ^ 0xA5) % 0x29]) ^ rand

# FUN_001025f decoded
for i in range(len(flag) - 1):
    flag[i] ^= 0 ^ 0xA5 ^ (key[(0 ^ 0xA5) % 0x29])

# Overwrite the random value
flag[len(int(flag)) - 1] = " "

# FLAG --> ASIS{Kn0w_7h4t_th3_l1fe_0f_thi5_wOrld_1s_8Ut_amu5em3nt_4nd_div3rsi0n_aNd_adOrnmen7}
